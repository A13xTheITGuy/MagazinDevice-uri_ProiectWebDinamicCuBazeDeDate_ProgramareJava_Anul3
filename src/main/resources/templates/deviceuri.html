<html xmlns:th="http://www.thymeleaf.org">
<header>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
	<title>
		Lista deviceuri baza de date magazin deviceuri
	</title>
	
	<style>
        .table-responsive-container {
            width: 100%;
            margin: 0 auto;
            overflow-x: auto;
        }
        table {
            table-layout: fixed;
            word-wrap: break-word;
        }
    </style>
</header>

<body>
<center>

<br>
<h1 th:text="${welcomeMessage}"/>
<h2 th:text="${allDevMessage}"/>
<br>

<br sec:authorize="hasRole('ADMIN')" >
<div sec:authorize="hasRole('ADMIN')">
    <h3>Administrare</h3>
    <a th:href="@{/admin/users}" class="btn btn-primary">Gestioneaza utilizatorii</a>
</div>

<br sec:authorize="hasRole('ADMIN')"><br>
<h3 th:text="${searchString}"/>

<form id="filtreSiCautareForm" method = "GET" th:action="@{/lista-deviceuri}">
<input type = "text" placeholder = "Cauta..." th:value = "${cautareOld}" name = "cautare_form"></input>
<br><br>
<h3 th:text="${filterString}"/>
<table>
<tr>
	<th>Capacitate RAM</th>
	<td>
		<select name = "capacitate_ram_form">
		<option value="0" th:selected="${capRAMOld == 0}">Oricat</option>
		<option value="1" th:selected="${capRAMOld == 1}">1 GB</option>
		<option value="2" th:selected="${capRAMOld == 2}">2 GB</option>
		<option value="4" th:selected="${capRAMOld == 4}">4 GB</option>
		<option value="6" th:selected="${capRAMOld == 6}">6 GB</option>
		<option value="8" th:selected="${capRAMOld == 8}">8 GB</option>
		<option value="12" th:selected="${capRAMOld == 12}">12 GB</option> 
		<option value="16" th:selected="${capRAMOld == 16}">16 GB</option> 
		<option value="18" th:selected="${capRAMOld == 18}">18 GB</option> 
		<option value="24" th:selected="${capRAMOld == 24}">24 GB</option> 
		<option value="32" th:selected="${capRAMOld == 32}">32 GB</option> 
		<option value="48" th:selected="${capRAMOld == 48}">48 GB</option> 
		<option value="64" th:selected="${capRAMOld == 64}">64 GB</option>
		<option value="96" th:selected="${capRAMOld == 96}">96 GB</option>
		<option value="128" th:selected="${capRAMOld == 128}">128 GB</option>
		<option value="256" th:selected="${capRAMOld == 256}">256 GB</option>
		</select> 
	</td>
</tr>
<tr>
	<th>Tip RAM</th>
	<td>
		<select name = "tip_RAM_form">
		<option value="" th:selected="${tipRAMOld == null}">Oricare</option>
		<option value="DDR1" th:selected="${tipRAMOld == 'DDR1'}">DDR1</option>
		<option value="DDR2" th:selected="${tipRAMOld == 'DDR2'}">DDR2</option>
		<option value="DDR3" th:selected="${tipRAMOld == 'DDR3'}">DDR3</option>
		<option value="DDR4" th:selected="${tipRAMOld == 'DDR4'}">DDR4</option>
		<option value="DDR5" th:selected="${tipRAMOld == 'DDR5'}">DDR5</option> 
		</select> 
	</td>
</tr>
<tr>
	<th>Capacitate stocare</th>
	<td>
		<select name = "cap_stocare_form">
		<option value="0" th:selected="${capStocareOld == ''}">Oricat</option>
		<option value="512" th:selected="${capStocareOld  == 512}">512 GB</option>
		<option value="1024" th:selected="${capStocareOld  == 1024}">1024 GB</option>
		<option value="2048" th:selected="${capStocareOld  == 2048}">2048 GB</option>
		<option value="4096" th:selected="${capStocareOld  == 4096}">4096 GB</option>
		</select> 
	</td>
</tr>
<tr>
	<th>Sistem de operare:</th>
	<td>
		<select name = "sistem_de_operare_form">
		<option value="" th:selected="${OSOld  == ''}">Oricare</option>
		<option value="Windows" th:selected="${OSOld  == 'Windows'}">Windows</option>
		<option value="Linux" th:selected="${OSOld  == 'Linux'}">Linux</option>
		<option value="Free_DOS" th:selected="${OSOld == 'Free_DOS'}">Free_DOS</option>
		<option value="Ubuntu" th:selected="${OSOld  == 'Ubuntu'}">Ubuntu</option> 
		</select> 
	</td>
</tr>
<tr>
	<th>Pret minim:</th>
	<td>
		<input type = "number" placeholder = "0" step="0.01" th:value = "${pretMinOld}" min = "0" max = "99999" name = "pret_min_form"></input>
	</td>
</tr>
<tr>
	<th>Pret maxim:</th>
	<td>
		<input type = "number" placeholder = "999999" step="0.01" th:value = "${pretMaxOld}" min = "0" max = "999999" name = "pret_max_form"></input>
	</td>
</tr>
</table>
<br>
<input type="submit" name="filtreaza_form" value="Filtreaza / cauta" class="btn btn-primary"/> 
<button type="button" onclick="resetFilters()" class="btn btn-danger">Sterge filtre / sterge cautare</button>
<script>
function resetFilters() {
	const form = document.getElementById('filtreSiCautareForm');
	form.querySelectorAll('input[type="text"]').forEach(i => i.value = "");
	form.querySelectorAll('input[type="number"]').forEach(i => i.value = "");
	form.querySelectorAll('select').forEach(s => s.selectedIndex = 0);
	form.submit();
}
</script>
</form>

<br><br>
<h3 th:text="${allDesktopsMessage}"/>
<br>
	<table class="table table-striped table-bordered" style="width:95%">
		<tr>
			<th sec:authorize="hasAnyRole('EDITOR','ADMIN')" >id_desktop</th>
			<th sec:authorize="hasAnyRole('ADMIN')">id_utilizator</th>
			<th>nume_sistem</th>
			<th>procesor</th>
			<th>placa_video</th>
			<th>capacitate_RAM</th>
			<th>tip_RAM</th>
			<th>frecventa_RAM</th>
			<th>tip_stocare</th>
			<th>capaticate_stocare</th>
			<th>sistem_de_operare</th>
			<th>culoare</th>
			<th>pret</th>
			<th sec:authorize="hasAnyRole('EDITOR','ADMIN')">ACTIUNI</th>
		</tr>
		<tr th:each="c : ${listaDesktopuri}">
			<td sec:authorize="hasAnyRole('EDITOR','ADMIN')" th:text="${c.id_desktop}"></td>
			<td sec:authorize="hasAnyRole('ADMIN')" th:text="${c.id_utilizator}"></td>
			<td th:text="${c.nume_sistem}"></td>
			<td th:text="${c.procesor}"></td>
			<td th:text="${c.placa_video}"></td>
			<td th:text="${c.capacitate_RAM}"></td>
			<td th:text="${c.tip_RAM}"></td>
			<td th:text="${c.frecventa_RAM}"></td>
			<td th:text="${c.tip_stocare}"></td>
			<td th:text="${c.capacitate_stocare}"></td>
			<td th:text="${c.sistem_de_operare}"></td>
			<td th:text="${c.culoare}"></td>
			<td th:text="${c.pret}"></td>
			
			<td sec:authorize="hasAnyRole('EDITOR','ADMIN')">
        		<a th:href="@{/desktopuri/edit/{id}(id=${c.id_desktop})}" class="btn btn-primary">Edit</a>

        		<form th:action="@{/desktopuri/delete/{id}(id=${c.id_desktop})}"
			          method="POST"
			          style="display:inline"
			          onsubmit="if(!confirm('Sigur doriti sa stergeti acest laptop?')){event.preventDefault();}">
			
			        <input type="hidden"
			               th:name="${_csrf.parameterName}"
			               th:value="${_csrf.token}" />
			
			        <button type="SUBMIT" class="btn btn-danger">
			            Delete
			        </button>
			    </form>
    		</td>
			
		</tr>
	</table>
	<div sec:authorize="hasAnyRole('EDITOR','ADMIN')">
    	<a th:href="@{/desktopuri/add}" class="btn btn-success">Adauga desktop</a>
	</div>
<br><br>
<h3 th:text="${allLaptopsMessage}"/>
<br>

	<table class="table table-striped table-bordered" style="width:95%">
		<tr>
			<th sec:authorize="hasAnyRole('EDITOR','ADMIN')" >id_laptop</th>
			<th sec:authorize="hasAnyRole('ADMIN')">id_utilizator</th>
			<th>nume_laptop</th>
			<th>procesor</th>
			<th>placa_video</th>
			<th>capacitate_RAM</th>
			<th>tip_RAM</th>
			<th>frecventa_RAM</th>
			<th>tip_stocare</th>
			<th>capaticate_stocare</th>
			<th>rezolutie_ecran</th>
			<th>dimensiune_ecran</th>
			<th>sistem_de_operare</th>
			<th>culoare</th>
			<th>pret</th>
			<th sec:authorize="hasAnyRole('EDITOR','ADMIN')">ACTIUNI</th>
		</tr>
		<tr th:each="c : ${listaLaptopuri}">
			<td sec:authorize="hasAnyRole('EDITOR','ADMIN')" th:text="${c.id_laptop}"></td>
			<td sec:authorize="hasAnyRole('ADMIN')" th:text="${c.id_utilizator}"></td>
			<td th:text="${c.nume_laptop}"></td>
			<td th:text="${c.procesor}"></td>
			<td th:text="${c.placa_video}"></td>
			<td th:text="${c.capacitate_RAM}"></td>
			<td th:text="${c.tip_RAM}"></td>
			<td th:text="${c.frecventa_RAM}"></td>
			<td th:text="${c.tip_stocare}"></td>
			<td th:text="${c.capacitate_stocare}"></td>
			<td th:text="${c.rezolutie_ecran}"></td>
			<td th:text="${c.dimensiune_ecran}"></td>
			<td th:text="${c.sistem_de_operare}"></td>
			<td th:text="${c.culoare}"></td>
			<td th:text="${c.pret}"></td>
			<td sec:authorize="hasAnyRole('EDITOR','ADMIN')">
        		<a th:href="@{/laptopuri/edit/{id}(id=${c.id_laptop})}" class="btn btn-primary">Edit</a>
        		<form th:action="@{/laptopuri/delete/{id}(id=${c.id_laptop})}"
			          method="POST"
			          style="display:inline"
			          onsubmit="if(!confirm('Sigur doriti sa stergeti acest laptop?')){event.preventDefault();}">
			
			        <input type="hidden"
			               th:name="${_csrf.parameterName}"
			               th:value="${_csrf.token}" />
			
			        <button type="SUBMIT" class="btn btn-danger">
			            Delete
			        </button>
			    </form>
    		</td>
		</tr>
	</table>
	
	<div sec:authorize="hasAnyRole('EDITOR','ADMIN')">
    	<a th:href="@{/laptopuri/add}" class="btn btn-success">Adauga laptop</a>
	</div>
	<br><br>
	<form th:action="@{/logout}" method="POST" style="display: inline;">
		<input type="hidden"
	           th:name="${_csrf.parameterName}"
	           th:value="${_csrf.token}" />
        <button type="submit" class="btn btn-primary">Logout</button>
    </form>
    <br><br>
	
</body>
</html>